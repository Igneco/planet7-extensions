Copied verbatim from https://github.com/milessabin/shapeless/blob/master/examples/src/main/scala/shapeless/examples/csv.scala